apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: data-tier-isolation
spec:
  # 1. Select the Database and Redis pods
  podSelector:
    matchExpressions:
      - {key: tier, operator: In, values: [database, cache]}
  policyTypes:
  - Ingress
  ingress:
  # 2. Allow traffic ONLY from the Backend pods
  - from:
    - podSelector:
        matchLabels:
          tier: backend